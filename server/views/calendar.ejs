<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset='utf-8' />
    <title>펫츠고 예약현황</title>
    <meta name="description" content="펫츠고와 함께 사랑하는 반려동물과의 여행을 시작 해 보세요">
    <link href='https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css' rel='stylesheet'>
    <link href='https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css' rel='stylesheet'>
    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.17/index.global.min.js'></script>
    <link rel="icon" type="image/png" href="https://cdn.imweb.me/thumbnail/20240429/9d1e4346c6e55.png" sizes="196x196">
    <style>
        body {
            margin: 40px 10px;
            padding: 0;
            font-family: "Lucida Grande", Helvetica, Arial, Verdana, sans-serif;
            font-size: 14px;
        }
        .fc-col-header-cell-cushion {
            text-decoration: none !important;
            color: #1a1a1a; /* 링크색도 원하면 수정 */
        }
        .fc-daygrid-event-dot {
            display: none !important;
        }
        .fc-daygrid-day-number {
            text-decoration: none !important;
            color: #1a1a1a; /* 링크색도 원하면 수정 */
        }
        .fc-daygrid-day-frame.fc-scrollgrid-sync-inner:hover {
            cursor: pointer;
            background-color: #f5f5f5 !important;
        }
        .banner {
            position: relative;
            height: 144px;
            overflow: hidden;
        }

        .banner img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .banner-overlay {
            position: absolute;
            inset: 0;
            background: linear-gradient(to bottom, rgba(0, 0, 0, 0.6), transparent);
        }

        .banner-text {
            position: absolute;
            z-index: 10;
            inset: 0;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: #fff;
            text-align: center;
        }

        .banner-text .title {
            font-size: 1.5rem;
            font-weight: bold;
        }

        .banner-text .subtitle {
            font-size: 1rem;
            font-weight: 600;
        }
    </style>
    <%
        const eventsJson = JSON.stringify(events);
    %>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            var calendarEl = document.getElementById('calendar');
            const events = <%- eventsJson%>

            var calendar = new FullCalendar.Calendar(calendarEl, {
                locale: 'ko',
                buttonText: {
                    today: '오늘',
                    month: '월',
                    week: '주',
                    day: '일',
                    list: '목록',
                },
                dateClick: function(info) {
                    const clickedDate = info.dateStr;
                    window.location.href = `/v1/service/calendar/${clickedDate}/list`;
                },
                themeSystem: 'bootstrap5',
                initialView: 'dayGridMonth',
                events: events,
                eventDidMount: function(info) {
                    const dotGroup = info.event.extendedProps.dotGroup;
                    console.log(dotGroup);
                    if (!dotGroup) return;

                    // 리스트 뷰에서 텍스트 영역 안에 도트들을 추가
                    const targetEl = info.el.querySelector('.fc-event-title');
                    console.log(targetEl)
                    if (!targetEl) return;

                    const wrapper = document.createElement('div');
                    wrapper.style.display = 'flex';
                    wrapper.style.justifyContent = 'center';
                    wrapper.style.alignItems = 'center';
                    wrapper.style.gap = '6px';
                    wrapper.style.marginTop = '4px';
                    wrapper.style.flexWrap = 'wrap';

                    dotGroup.forEach(dot => {
                        const dotEl = document.createElement('div');
                        dotEl.style.width = '10px';
                        dotEl.style.height = '10px';
                        dotEl.style.borderRadius = '50%';
                        dotEl.style.backgroundColor = dot.color || '#ccc';
                        wrapper.appendChild(dotEl);
                    });

                    targetEl.innerHTML = info.event.title; // 제목 다시 세팅 (덮어씌우기 방지)
                    targetEl.appendChild(wrapper);
                }
            });

            calendar.render();
        });

    </script>
    <style>
        #wrap {
            max-width: 720px;
            margin: 0 auto;
        }

        #calendar {
            max-width: 720px;
            margin: 0 auto;
            padding-top: 1rem;
        }

        .legend {
            display: flex;
            justify-content: center;
            gap: 1.25rem;
            padding: 1rem;
            font-size: 0.875rem;
            color: #555;
            border: 1px solid #e5e5e5;
            border-radius: 0.25rem;
        }

        .dot {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 6px;
        }

        .dot.confirmed {
            background-color: hsl(220, 100%, 50%); /* 파란색 */
        }

        .dot.potential {
            background-color: hsl(134, 65%, 58%); /* 초록색 */
        }

        .dot.open {
            background-color: hsl(0, 0%, 60%); /* 회색 */
        }
    </style>
</head>

<body>
    <div id="wrap">
        <section class="banner">
            <img src="/public/petsgo.png" alt="Slide 2">
            <div class="banner-overlay"></div>
            <div class="banner-text">
                <div class="title">펫츠고</div>
                <div class="subtitle">사랑하는 반려동물과의 여행을 시작 해 보세요</div>
            </div>
        </section>
        <div class="legend">
            <div><span class="dot confirmed"></span>출발 확정</div>
            <div><span class="dot potential"></span>출발 유력</div>
            <div><span class="dot open"></span>모객 중</div>
        </div>
        <div id='calendar'></div>
    </div>
</body>

</html>